<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predict Instance Type</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-8E18Zj6L6ujZVAE+uSsxVR6qLMBXqQ0LoyImVgeO5K9gI+ADG7nZRkoG0vcojCwl5CgDWSzrbn+Fz8H7kC2U9g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script defer src="/js/common.js"></script>
    <script defer src="/js/predict.js"></script>
</head>
<body class="bg-gray-50 text-gray-900 min-h-screen flex flex-col">
    <header class="bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-6 py-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
            <div>
                <a href="/" class="inline-flex items-center gap-3 text-green-600 hover:text-green-700 transition">
                    <i class="fas fa-arrow-left"></i>
                    Back to welcome
                </a>
                <h1 class="text-3xl font-bold mt-3 sm:mt-1 text-gray-900">Prediction Lab</h1>
                <p class="text-gray-600 text-sm mt-1">Fill in live telemetry to let the LSTM select the optimal AWS instance configuration.</p>
            </div>
            <nav class="flex gap-3 text-sm">
                <a href="/predict" class="px-4 py-2 rounded-lg bg-green-600 text-white font-semibold hover:bg-green-700 transition">Predict</a>
                <a href="/real-time" class="px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition text-gray-700">Real-Time</a>
            </nav>
        </div>
    </header>

    <main class="flex-1">
        <section class="max-w-7xl mx-auto px-6 py-12">
            <div class="grid lg:grid-cols-[1fr_380px] gap-10">
                <form id="prediction-form" class="bg-white border border-gray-200 rounded-xl p-8 space-y-8 shadow-sm">
                    <div>
                        <h2 class="text-2xl font-semibold text-gray-900">Workload metrics</h2>
                        <p class="mt-2 text-sm text-gray-600">Provide the six normalized KPIs that the model expects to infer the right instance family.</p>
                    </div>

                    <div class="grid sm:grid-cols-2 gap-6">
                        <label class="flex flex-col gap-2 text-sm">
                            <span class="text-gray-700 font-medium">CPU Utilization (%)</span>
                            <input type="number" name="CPU_Utilization_Percent" min="0" max="100" step="0.1" required class="px-4 py-3 rounded-lg bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </label>
                        <label class="flex flex-col gap-2 text-sm">
                            <span class="text-gray-700 font-medium">Memory Utilization (%)</span>
                            <input type="number" name="Memory_Utilization_Percent" min="0" max="100" step="0.1" required class="px-4 py-3 rounded-lg bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </label>
                        <label class="flex flex-col gap-2 text-sm">
                            <span class="text-gray-700 font-medium">Network In (Mbps)</span>
                            <input type="number" name="Network_In_Mbps" min="0" step="0.1" required class="px-4 py-3 rounded-lg bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </label>
                        <label class="flex flex-col gap-2 text-sm">
                            <span class="text-gray-700 font-medium">Network Out (Mbps)</span>
                            <input type="number" name="Network_Out_Mbps" min="0" step="0.1" required class="px-4 py-3 rounded-lg bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </label>
                        <label class="flex flex-col gap-2 text-sm">
                            <span class="text-gray-700 font-medium">Disk Usage (%)</span>
                            <input type="number" name="Disk_Usage_Percent" min="0" max="100" step="0.1" required class="px-4 py-3 rounded-lg bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </label>
                        <label class="flex flex-col gap-2 text-sm">
                            <span class="text-gray-700 font-medium">Response Time (ms)</span>
                            <input type="number" name="Response_Time_ms" min="0" step="0.1" required class="px-4 py-3 rounded-lg bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </label>
                    </div>

                    <div class="flex flex-col sm:flex-row sm:items-center gap-4">
                        <button type="submit" class="inline-flex items-center justify-center gap-3 px-6 py-3 rounded-lg bg-green-600 text-white font-semibold shadow-lg hover:bg-green-700 transition disabled:opacity-50"><i class="fas fa-rocket"></i> Run Prediction</button>
                        <button type="reset" class="px-6 py-3 rounded-lg border border-gray-300 hover:border-gray-400 transition text-gray-700">Reset metrics</button>
                    </div>
                    <p id="form-error" class="hidden text-sm text-red-600"></p>
                </form>

                <aside class="space-y-6">
                    <div class="bg-green-50 border border-green-200 rounded-xl p-8 shadow-sm" id="prediction-card">
                        <p class="text-sm uppercase tracking-wide text-green-700 font-semibold">Prediction</p>
                        <h2 class="text-3xl font-semibold text-gray-900 mt-4" id="prediction-title">Awaiting input</h2>
                        <p class="mt-2 text-gray-600 text-sm" id="prediction-subtitle">Submit workload metrics to see the recommendation.</p>
                        <dl class="mt-6 space-y-3 text-sm" id="prediction-metadata"></dl>
                    </div>

                    <div class="bg-white border border-gray-200 rounded-xl p-6 hidden shadow-sm" id="comparison-card">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Model Comparison</h3>
                            <span class="text-xs uppercase tracking-wide text-gray-500">Current vs Recommended</span>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
                                <div class="text-xs font-medium text-blue-600 mb-1">Current (LSTM Model)</div>
                                <div class="text-2xl font-bold text-blue-900" id="lstm-instance">—</div>
                            </div>
                            <div class="bg-green-50 rounded-lg p-4 border border-green-200">
                                <div class="text-xs font-medium text-green-600 mb-1">Recommended (Gemini AI)</div>
                                <div class="text-2xl font-bold text-green-900" id="gemini-instance">—</div>
                                <div class="text-xs text-green-700 mt-1" id="gemini-confidence"></div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 rounded-lg p-3 mb-4" id="gemini-reasoning-container" style="display: none;">
                            <div class="text-xs font-medium text-gray-600 mb-1">Gemini Reasoning:</div>
                            <div class="text-sm text-gray-700" id="gemini-reasoning"></div>
                        </div>
                    </div>

                    <div class="bg-white border border-gray-200 rounded-xl p-6 hidden shadow-sm" id="spider-chart-card">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Workload Profile</h3>
                            <span class="text-xs uppercase tracking-wide text-gray-500">Spider Chart</span>
                        </div>
                        <div class="relative" style="height: 350px;">
                            <canvas id="spider-chart"></canvas>
                        </div>
                    </div>
                </aside>
            </div>
        </section>
    </main>

    <footer class="border-t border-gray-200 bg-white">
        <div class="max-w-7xl mx-auto px-6 py-6 text-sm text-gray-600">
            <p>Built on Flask • TailwindCSS client • <a href="/real-time" class="underline hover:text-green-600">View real-time optimization</a></p>
        </div>
    </footer>
</body>
</html>
